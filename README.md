# Интерактивное веб-приложение предназначеное для прогноза риска инсульта у пациентов в медицинских учреждениях
Приложение реализовано с помощью Streamlit и размещено на платформе Streamlit Cloud, интегрированной с GitHub. Работа приложения и прогноза основана на использовании ранее обученой модели градиентного бустинга, которая загружается внутри app.py. Приложение позволяет предсказать классы (от 0.50 до 1 - высокий риск, от 0 до 0.50 - низкий риск), где 1 - высокий риск инсульта и 0 - низкий риск инсульта.
![Статус разработки](https://img.shields.io/badge/Статус-В%20разработке-yellow)
![Сборка](https://img.shields.io/badge/Сборка-Успешна-brightgreen)
![Покрытие тестами](https://img.shields.io/badge/Покрытие-85%25-blue)
![Лицензия](https://img.shields.io/badge/Лицензия-MIT-green)

## Содержание
- [Технологии](#технологии)
- [Начало работы](#начало-работы)
- [Тестирование](#тестирование)
- [Deploy и CI/CD](#deploy-и-ci/cd)
- [Contributing](#contributing)
- [To do](#to-do)
- [Команда проекта](#команда-проекта)

## Технологии
- Python 3.14.0
- Streamlit
- Pandas
- Joblib

## Использование
### Установка и запуск проекта

1. **Клонируйте репозиторий:**
```bash
git clone https://github.com/ваш_пользователь/имя_репозитория.git
```
Установите зависимости:
```bash
pip install -r requirements.txt
```
Если файла requirements.txt еще нет, создайте его со следующим содержимым:

streamlit  
pandas   
scikit-learn  
joblib  

Запустите приложение:
```bash
streamlit run app.py
```
После этого в командной строке появится ссылка (например, http://localhost:8501), по которой откроется ваше приложение в браузере.

##Использование приложения

1. Введите данные пациента в форму, заполнив поля такие как пол, возраст, наличие гипертензии и др.  
2. После заполнения нажмите кнопку "Оценить риск инсульта".  
3. На экране появится вероятность и оценка риска инсульта (высокий или низкий).  

## Разработка
### Требования
Для разработки и запуска проекта у вас должны быть установлены:

- Python версии 3.8 или выше
- pip для установки зависимостей

### Установка зависимостей
Клонируйте репозиторий и установите необходимые библиотеки:
```bash
git clone https://github.com/ваш_пользователь/имя_репозитория.git
pip install -r requirements.txt
```
Если файла requirements.txt пока нет, создайте его с содержимым:
streamlit  
pandas  
scikit-learn  
joblib
  
или установите зависимости вручную:

```bash
pip install streamlit pandas scikit-learn joblib
```
Запуск в режиме разработки
Запустите приложение командой:
```bash
streamlit run app.py
```
После запуска в терминале появится ссылка (локальный сервер), обычно http://localhost:8501, по которой вы сможете открыть приложение в браузере.

## Тестирование
Данный проект может быть дополнительно протестирован с помощью модульных или интеграционных тестов для обеспечения корректной работы модели, обработки данных и интерфейса.

### Как реализовать тесты

Поскольку проект использует Python, рекомендуется использовать стандартные библиотеки для тестирования, такие как `unittest` или популярные фреймворки `pytest`.

### Пример простого теста модели

Создайте файл `test_model.py` в папке `tests` или в корне проекта, например:

```python
import joblib
import pandas as pd

def test_model_prediction():
    model = joblib.load('gradient_boosting_model.pkl')
    test_input = pd.DataFrame({
        'gender': [1], 
        'age': [50],
        'hypertension': [0],
        'heart_disease': [0],
        'ever_married': [1],
        'work_type': [0],
        'Residence_type': [1],
        'avg_glucose_level': [100],
        'smoking_status': [0]
    })

    prediction = model.predict(test_input)
    probability = model.predict_proba(test_input)[0][1]

    # Проверьте, что prediction — это либо 0, либо 1
    assert prediction in [0, 1], "Prediction должна быть 0 или 1"
    # Проверка вероятности
    assert 0.0 <= probability <= 1.0, "Вероятность должна быть в диапазоне 0-1"
```
Как запускать тесты
Убедитесь, что у вас установлен pytest:
```bash
pip install pytest
```
Запустите тесты командой:
```bash
pytest
```
или, если используете unittest:

```bash
python -m unittest discover -s tests
```

## Deploy и CI/CD
### Развертывание приложения

Это приложение предназначено для работы на платформе Streamlit Cloud, которая автоматически интегрируется с вашим репозиторием на GitHub. Вот основные шаги для развертывания:

1. **Подготовка репозитория:##
   - Убедитесь, что все необходимые файлы находятся в репозитории:
     - `app.py` — основной скрипт приложения
     - `gradient_boosting_model.pkl` — обученная модель
     - `requirements.txt` — список зависимостей
2. **Настройка репозитория на Streamlit Cloud:##
   - Зайдите на [Streamlit Cloud](https://streamlit.io/cloud)
   - Создайте аккаунт или войдите
   - Нажмите "New app" (Новое приложение)
   - Свяжите его с вашим GitHub репозиторием
   - Укажите ветку (например, `main`) и путь к файлу `app.py`
3. **Автоматический деплой:##
   - После настройки, Streamlit Cloud автоматически запустит приложение и будет следить за обновлениями в выбранной ветке.
   
### Настройка пайплайнов (CI/CD)

Для автоматического тестирования и обновления модели, можно настроить CI/CD через GitHub Actions:

1. Создайте файл `.github/workflows/ci.yml` в вашем репозитории.
2. Пример содержимого файла:

```yaml
name: CI/CD Pipeline

on:
  push:
    branches:
      - main  # или ваша ветка

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2

    - name: Set up Python
      uses: actions/setup-python@v2
      with:
        python-version: '3.8'

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    - name: Run tests
      run: |
        # Добавьте команды для запуска тестов, если они есть
        echo "Тесты не настроены"
      
    - name: Deploy model (при необходимости)
      # Добавьте шаги для автоматического обновления модели или деплоя, если есть
```

## Contributing
Вы можете помочь проекту, предложив улучшения, исправления или добавление новых функций.
Пожалуйста, создавайте pull requests по стандартным гайдам и придерживайтесь созвучных стилей кода. Перед внесением изменений убедитесь, что тесты проходят успешно. 

Перед тем как отправлять изменения, пожалуйста, ознакомьтесь с нашим несколькими рекомендациями:
1. Создайте форк репозитория и клонируйте его к себе
```bash
git clone https://github.com/ssssseredin-ux/my-streamlit-app.git
```
Создайте новую ветку для своих изменений:
```bash
git checkout -b feature/описание_фичи
```
Внесите свои изменения и протестируйте их.

Коммитите изменения с понятным сообщением:

```bash
git commit -m "Добавил описание функции или исправление"
```
Отправляйте ветку в свой форк:
```bash
git push origin feature/описание_фичи
```
Откройте Pull Request в основной репозиторий и опишите сделанные изменения.
Правила оформления:
Следуйте стильгайду Python и соглашениям по коду.
Перед отправкой убедитесь, что все тесты проходят (если есть тесты).
Пишите комментарии и документацию для новых функций.
Мы ценим каждый вклад! Изначальные идеи, исправления ошибок, новые функции — всё важно для развития проекта.

## FAQ 
## В:Как запустить приложение у себя на компьютере? 
О: Сначала установите все необходимые библиотеки, выполнив команду:
```bash
pip install -r requirements.txt
```
Затем запустите приложение командой:
```bash
streamlit run app.py
```
После этого оно откроется в браузере по умолчанию.

## В: Какие данные необходимо вводить для получения прогноза?
О: Вам нужно заполнить форму, включающую:

1.Пол (Мужской / Женский)  
2.Возраст (от 18 до 100)  
3.Наличие гипертензии  
4.Болезни сердца  
5.Семейное положение  
6.Тип работы  
7.Тип проживания  
8.Средний уровень глюкозы  
9.Статус курения  
10.После нажмите кнопку "Оценить риск инсульта".  

## В: Можно ли использовать приложение для оценки других заболеваний или состояний?

О: На текущий момент приложение настроено для оценки риска инсульта на основе предоставленных признаков. Для разработки моделей под другие заболеваниия требуется обучение новых моделей и обновление приложения.

## В: Где находится обученная модель и как ее обновлять?

О: Модель сохранена в файле gradient_boosting_model.pkl. Чтобы заменить модель, обучите новую версию и замените файл в репозитории.

## В: Как расширить функционал или добавить новые признаки?

О: Для этого потребуется подготовить новые данные, обучить модель заново и обновить код приложения, добавив новые поля формы и соответствующую обработку.

## В: Где взять исходный код модели?

О: Исходный код и данные для обучения модели находятся в репозитории, обычно в папке или ветке, предназначенной для разработки.

### Зачем вы разработали этот проект?
Проект направлен на оптимизацию финансовых расходов как частных так и государственных клиник, в рамках затрат на дообследования пациентов а также предупреждения новых затрат в плане реабилитации пациентов. Также для высвобождения времени у медицинского персонала и ускорения диагностических шагов.

## To do
- [ ] Добавить тесты для проверки корректности модели и интерфейса.
- [ ] Внедрить автоматическую проверку качества модели (например, оценку точности на тестовых данных).
- [ ] Настроить CI/CD для автоматического деплоя и тестирования (GitHub Actions, CirclCI и т.п.).
- [ ] Обеспечить возможность обновления обученной модели через коммиты или интерфейс.
- [ ] Добавить описание и пояснения к признакам в интерфейсе или в отдельной документации.
- [ ] Расширить функционал: добавить возможность прогнозирования по другим критериям или заболеваниям.
- [ ] Сделать локальную документацию и инструкцию по серверам и запуску.
- [ ] Улучшить дизайн интерфейса (может быть, внедрить стили или добавить пояснительные подсказки).
- [ ] Собрать отзывы пользователей и внедрить улучшения.
- [ ] Подключить систему логирования и отслеживания ошибок.
- [ ] Обновить файл requirements.txt на основе актуальных зависимостей.
- [ ] Оформить более подробный раздел "Contributing" для потенциальных внешних вкладчиков.

## Команда проекта
- [Гречаник Кирилл](tg://resolve?domain=kirseredin) — Data Analyst 

## Источники
https://www.who.int/ru/ - Данные и статьи Всемирной организации здравоохранения  
https://www.kaggle.com/code/desalegngeb/heart-disease-predictions - Исследование решений и опыта на данных прогноза болезни сердца  
https://cyberleninka.ru/article/n/analiz-effektivnosti-programmy-otsenka-riska-insulta-dlya-vyyavleniya-lits-s-vysokim-riskom-insulta/viewer - Исследование традиционных методов оценки риска инсульта
